# 位运算

## 二进制
在计算机中，数字存储都是以二进制表示

### 原码
原码(true form)是一种计算机中对数字的二进制定点表示方法。原码表示法在数值前面增加了一位符号位（即最高位为符号位）：正数该位为0，负数该位为1（0有两种表示：+0和-0），其余位表示数值的大小。
例如JavaScript使用位移的话，都是32位整数（包括符号位）

#### 优点
简单直观；例如，我们用8位二进制表示一个数，+11的原码为00001011，-11的原码就是10001011

#### 缺点
原码不能直接参加运算，可能会出错。例如数学上，1+(-1)=0，而在二进制中00000001+10000001=10000010，换算成十进制为-2。显然出错了。所以原码的符号位不能直接参与运算，必须和其他位分开，这就增加了硬件的开销和复杂性


### 反码
反码是数值存储的一种，多应用于系统环境设置，如linux平台的目录和文件的默认权限的设置umask，就是使用反码原理。
正数的反码与其原码相同；负数的反码是对正数逐位取反，符号位保持为1.对于二进制原码 10010 求反码：
（（10010）原）反=对正数(00010)原含符号位取反= 反码11101 （10010，1为符号码，故为负）

### 补码 
求负整数的补码，将其原码除符号位外的所有位取反（0变1，1变0，符号位为1不变）后加1
补码转原码，将其补码除符号位外的所有位取反（0变1，1变0，符号位为1不变）加1

1. 解决了符号的表示的问题
2. 以将减法运算转化为补码的加法运算来实现，克服了原码加减法运算繁杂的弊端，可有效简化运算器的设计
3. 在计算机中，利用电子器件的特点实现补码和真值、原码之间的相互转换，非常容易
4. 补码表示统一了符号位和数值位，使得符号位可以和数值位一起直接参与运算，这也为后面设计乘法器除法器等运算器件提供了极大的方便。总之，补码概念的引入和当时运算器设计的背景不无关系，从设计者角度，既要考虑表示的数的类型(小数、整数、实数和复数)、数值范围和精确度，又要考虑数据存储和处理所需要的硬件代价。因此，使用补码来表示机器数并得到广泛的应用，也就不难理解了。


## 位运算种类

### 按位与运算（&）
定义：参加运算的两个数据，按二进制位进行"与"运算。两个位都为1时，结果才为1

与运算的用途:
1. 清零
如果想将一个单元清零，即使其全部二进制位为0，只要与一个各位都为零的数值相与，结果为零。


2. 取一个数的指定位
比如取数 X=1010 1110 的低4位，只需要另找一个数Y，令Y的低4位为1，其余位为0，即Y=0000 1111，然后将X与Y进行按位与运算（X&Y=0000 1110）即可得到X的指定位。


3. 判断奇偶
只要根据最未位是0还是1来决定，为0就是偶数，为1就是奇数。因此可以用if ((a & 1) == 0)代替if (a % 2 == 0)来判断a是不是偶数。

4. 判断数字之间二进制位是否有交叉
如果两个数字在二进制某位上都为1，那么 `a & b` 必定不为 0




### 按位或运算符 (|)
参加运算的两个对象，按二进制位进行"或"运算。两个位只要一个为1时，值就为1

或运算的用途:
1. 常用来对一个数据的某些位设置为1
比如将数 X=1010 1110 的低4位设置为1，只需要另找一个数Y，令Y的低4位为1，其余位为0，即Y=0000 1111，然后将X与Y进行按位或运算（X|Y=1010 1111）即可得到。





### 异或运算符 (^)
参加运算的两个数据，按二进制位进行"异或"运算。如果两个相应位相同为0，相异为1。

异或运算的用途:
1. 翻转指定位
比如将数 X=1010 1110 的低4位进行翻转，只需要另找一个数Y，令Y的低4位为1，其余位为0，即Y=0000 1111，然后将X与Y进行异或运算（X^Y=1010 0001）即可得到。


2. 与0相异或值不变
例如：1010 1110 ^ 0000 0000 = 1010 1110


3. 交换两个数
```js
function swap(a,b) {
    if (a != b){
        a ^= b;
        b ^= a;
        a ^= b;
    }
}
```

### 取反运算符 (~)
参加运算的一个数据，按二进制进行"取反"运算。对一个二进制数按位取反，即将0变1，1变0。

异或运算的用途：
1. 使一个数的最低位为零
使a的最低位为0，可以表示为：a & ~1。~1的值为 1111 1111 1111 1110，再按"与"运算，最低位一定为0。因为" ~"运算符的优先级比算术运算符、关系运算符、逻辑运算符和其他运算符都高。

### 左移运算符 (<<) 
将一个运算对象的各二进制位全部左移若干位（左边的二进制位丢弃，右边补0）。

设 a=1010 1110，a = a<< 2 将a的二进制位左移2位、右补0，即得a=1011 1000。
若左移时舍弃的高位不包含1，则每左移一位，相当于该数乘以2。

### 右移运算符 (>>)
将一个数的各二进制位全部右移若干位，正数左补0，负数左补1，右边丢弃。



### 复合赋值运算符
位运算符与赋值运算符结合，组成新的复合赋值运算符
a&=b  相当于  a=a&b
a|=b  相当于  a=a|b
a>>=b  相当于  a=a>>b
a<<=b  相当于  a=a<<b
a^=b  相当于  a=a^b